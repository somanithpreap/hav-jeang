// =====================
// Datasource & Generator
// =====================
datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

// =====================
// Models
// =====================
<<<<<<< HEAD
model User {
  id               Int              @id @default(autoincrement())
  name             String           @db.VarChar(100)
  phone            String           @unique @db.VarChar(20)
  password         String           @db.VarChar(255)
  created_at       DateTime         @default(now())
  usertype         UserType
  working_hours    String?          @db.VarChar(100)
  mechanic_lat   Float?
  mechanic_lng   Float?

  service         Service[]        // services mechanic provides
  serviceRequests  ServiceRequest[] // requests customer made
}

model Service {
  id           Int              @id @default(autoincrement())
  name         String           @db.VarChar(100)
  price        Int
  serviceType  ServiceType

  mechanicId   Int
  mechanic     User             @relation(fields: [mechanicId], references: [id])

  requests     ServiceRequest[] @relation("ServiceOnRequest") // many-to-many
=======

model User {
  id               Int              @id @default(autoincrement())
  name             String           @db.VarChar(100)
  phone String @unique @db.VarChar(20)
  password         String           @db.VarChar(255)
  created_at       DateTime         @default(now())
  usertype         UserType

  services         Service[]
  serviceRequests  ServiceRequest[]
}

model Service {
  id            Int          @id @default(autoincrement())
  name          String       @db.VarChar(100)
  price         Decimal      @db.Decimal(10, 2)
  shopaddress   String       @db.VarChar(255)
  location_lat  Float
  location_lan  Float
  serviceType   ServiceType

  mechanicId    Int
  mechanic      User         @relation(fields: [mechanicId], references: [id])

  requests      ServiceRequest[]
>>>>>>> 779674098868fce73f0f756da07944cecd5d4721

  @@index([mechanicId])
}

model ServiceRequest {
  id           Int              @id @default(autoincrement())
  request_date DateTime         @default(now())
  status       RequestStatus
<<<<<<< HEAD
  description  String?          @db.VarChar(500)
  address      String           @db.VarChar(255)
  request_lat  Float
  request_lng  Float
  trip_price  Int
  total_price  Int

  customerId   Int
  customer     User             @relation(fields: [customerId], references: [id])

  service     Service[]        @relation("ServiceOnRequest") // many-to-many

  @@index([customerId])
}


=======
  description  String?           @db.VarChar(500)
  address      String           @db.VarChar(255)
  request_lat  Float
  request_lan  Float

  customerId   Int
  serviceId    Int

  customer     User             @relation(fields: [customerId], references: [id])
  service      Service          @relation(fields: [serviceId], references: [id])

  @@index([customerId])
  @@index([serviceId])
}

>>>>>>> 779674098868fce73f0f756da07944cecd5d4721
// =====================
// Enums
// =====================

enum RequestStatus {
  pending
  completed
  cancelled
<<<<<<< HEAD
  accepted
=======
>>>>>>> 779674098868fce73f0f756da07944cecd5d4721
}

enum ServiceType {
  moto
  car
}

enum UserType {
  customer
  mechanic
}
